Reading the training set... 0.20229005813598633
Transforming the datasets... Number of features=  543
439 train sequences
0.26642918586730957
Pad sequences (samples x time)
x_train shape: (439, 400)
Transforming the labels... 2022-03-11 14:42:45.181356: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-11 14:42:45.554944: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
Class labels =  ['A2', 'A1', 'B1', 'B2', 'C1']
y_train shape: (439, 5)
0.00036525726318359375
Build model...
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        (None, 400, 100)          54300     
_________________________________________________________________
flatten (Flatten)            (None, 40000)             0         
_________________________________________________________________
dense (Dense)                (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 5s - loss: 1.6129 - accuracy: 0.0312 8/13 [=================>............] - ETA: 0s - loss: 1.6118 - accuracy: 0.101613/13 [==============================] - 1s 8ms/step - loss: 1.6093 - accuracy: 0.1646
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.6045 - accuracy: 0.2188 7/13 [===============>..............] - ETA: 0s - loss: 1.6028 - accuracy: 0.263413/13 [==============================] - 0s 8ms/step - loss: 1.5988 - accuracy: 0.3367
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5966 - accuracy: 0.4688 7/13 [===============>..............] - ETA: 0s - loss: 1.5899 - accuracy: 0.442013/13 [==============================] - 0s 9ms/step - loss: 1.5884 - accuracy: 0.4532
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5885 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5814 - accuracy: 0.486613/13 [==============================] - 0s 8ms/step - loss: 1.5781 - accuracy: 0.4962
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5773 - accuracy: 0.5000 6/13 [============>.................] - ETA: 0s - loss: 1.5752 - accuracy: 0.427112/13 [==========================>...] - ETA: 0s - loss: 1.5679 - accuracy: 0.500013/13 [==============================] - 0s 9ms/step - loss: 1.5679 - accuracy: 0.4911
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5603 - accuracy: 0.5312 7/13 [===============>..............] - ETA: 0s - loss: 1.5608 - accuracy: 0.504513/13 [==============================] - 0s 8ms/step - loss: 1.5579 - accuracy: 0.5114
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5370 - accuracy: 0.7188 7/13 [===============>..............] - ETA: 0s - loss: 1.5505 - accuracy: 0.526812/13 [==========================>...] - ETA: 0s - loss: 1.5477 - accuracy: 0.510413/13 [==============================] - 0s 10ms/step - loss: 1.5480 - accuracy: 0.5089
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5375 - accuracy: 0.5000 6/13 [============>.................] - ETA: 0s - loss: 1.5384 - accuracy: 0.515612/13 [==========================>...] - ETA: 0s - loss: 1.5383 - accuracy: 0.520813/13 [==============================] - 0s 9ms/step - loss: 1.5383 - accuracy: 0.5165
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5094 - accuracy: 0.7188 7/13 [===============>..............] - ETA: 0s - loss: 1.5313 - accuracy: 0.495513/13 [==============================] - 0s 8ms/step - loss: 1.5286 - accuracy: 0.5215
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.4987 - accuracy: 0.7812 7/13 [===============>..............] - ETA: 0s - loss: 1.5194 - accuracy: 0.540213/13 [==============================] - 0s 8ms/step - loss: 1.5190 - accuracy: 0.5241
[[17  0  2  0  0]
 [ 0  0  0  0  0]
 [12  0  5  0  0]
 [ 5  0  3  0  0]
 [ 0  0  0  0  0]]
2.056408166885376

Build model...
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_1 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 3s - loss: 1.6335 - accuracy: 0.1562 7/13 [===============>..............] - ETA: 0s - loss: 1.6150 - accuracy: 0.263413/13 [==============================] - ETA: 0s - loss: 1.6155 - accuracy: 0.250613/13 [==============================] - 0s 8ms/step - loss: 1.6155 - accuracy: 0.2506
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.6116 - accuracy: 0.2188 7/13 [===============>..............] - ETA: 0s - loss: 1.6093 - accuracy: 0.285713/13 [==============================] - ETA: 0s - loss: 1.6049 - accuracy: 0.316513/13 [==============================] - 0s 9ms/step - loss: 1.6049 - accuracy: 0.3165
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5980 - accuracy: 0.3438 7/13 [===============>..............] - ETA: 0s - loss: 1.5982 - accuracy: 0.321413/13 [==============================] - 0s 8ms/step - loss: 1.5944 - accuracy: 0.3620
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5941 - accuracy: 0.3438 7/13 [===============>..............] - ETA: 0s - loss: 1.5863 - accuracy: 0.361613/13 [==============================] - 0s 8ms/step - loss: 1.5840 - accuracy: 0.3696
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5809 - accuracy: 0.3438 7/13 [===============>..............] - ETA: 0s - loss: 1.5731 - accuracy: 0.401813/13 [==============================] - 0s 8ms/step - loss: 1.5737 - accuracy: 0.3671
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5605 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5641 - accuracy: 0.397313/13 [==============================] - 0s 9ms/step - loss: 1.5637 - accuracy: 0.3696
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5656 - accuracy: 0.3438 6/13 [============>.................] - ETA: 0s - loss: 1.5528 - accuracy: 0.406212/13 [==========================>...] - ETA: 0s - loss: 1.5535 - accuracy: 0.380213/13 [==============================] - 0s 9ms/step - loss: 1.5537 - accuracy: 0.3722
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5562 - accuracy: 0.2812 6/13 [============>.................] - ETA: 0s - loss: 1.5511 - accuracy: 0.338513/13 [==============================] - ETA: 0s - loss: 1.5437 - accuracy: 0.374713/13 [==============================] - 0s 9ms/step - loss: 1.5437 - accuracy: 0.3747
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5436 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5367 - accuracy: 0.388413/13 [==============================] - 0s 8ms/step - loss: 1.5338 - accuracy: 0.3873
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5230 - accuracy: 0.3438 7/13 [===============>..............] - ETA: 0s - loss: 1.5260 - accuracy: 0.415213/13 [==============================] - 0s 8ms/step - loss: 1.5242 - accuracy: 0.4076
[[ 9  0 10  0  0]
 [ 0  0  0  0  0]
 [ 2  0 15  0  0]
 [ 0  0  8  0  0]
 [ 0  0  0  0  0]]
1.5468437671661377

Build model...
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_2 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_2 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 3s - loss: 1.5999 - accuracy: 0.3125 8/13 [=================>............] - ETA: 0s - loss: 1.5943 - accuracy: 0.257813/13 [==============================] - 0s 8ms/step - loss: 1.5932 - accuracy: 0.2532
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5870 - accuracy: 0.3125 7/13 [===============>..............] - ETA: 0s - loss: 1.5855 - accuracy: 0.357113/13 [==============================] - 0s 8ms/step - loss: 1.5820 - accuracy: 0.3848
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5739 - accuracy: 0.4688 7/13 [===============>..............] - ETA: 0s - loss: 1.5716 - accuracy: 0.473213/13 [==============================] - 0s 8ms/step - loss: 1.5711 - accuracy: 0.4684
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5701 - accuracy: 0.4375 7/13 [===============>..............] - ETA: 0s - loss: 1.5621 - accuracy: 0.477713/13 [==============================] - 0s 9ms/step - loss: 1.5601 - accuracy: 0.5114
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5601 - accuracy: 0.4688 8/13 [=================>............] - ETA: 0s - loss: 1.5498 - accuracy: 0.546913/13 [==============================] - 0s 8ms/step - loss: 1.5491 - accuracy: 0.5316
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5452 - accuracy: 0.5312 7/13 [===============>..............] - ETA: 0s - loss: 1.5386 - accuracy: 0.531213/13 [==============================] - 0s 8ms/step - loss: 1.5384 - accuracy: 0.5291
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5283 - accuracy: 0.5625 7/13 [===============>..............] - ETA: 0s - loss: 1.5317 - accuracy: 0.522313/13 [==============================] - 0s 8ms/step - loss: 1.5278 - accuracy: 0.5468
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5312 - accuracy: 0.3750 7/13 [===============>..............] - ETA: 0s - loss: 1.5205 - accuracy: 0.544613/13 [==============================] - 0s 8ms/step - loss: 1.5173 - accuracy: 0.5544
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5032 - accuracy: 0.6562 7/13 [===============>..............] - ETA: 0s - loss: 1.5065 - accuracy: 0.553613/13 [==============================] - 0s 9ms/step - loss: 1.5070 - accuracy: 0.5595
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5044 - accuracy: 0.5938 7/13 [===============>..............] - ETA: 0s - loss: 1.5006 - accuracy: 0.553613/13 [==============================] - ETA: 0s - loss: 1.4972 - accuracy: 0.559513/13 [==============================] - 0s 9ms/step - loss: 1.4972 - accuracy: 0.5595
[[17  0  2  0  0]
 [ 0  0  0  0  0]
 [13  0  4  0  0]
 [ 2  0  6  0  0]
 [ 0  0  0  0  0]]
1.5365769863128662

Build model...
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_3 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_3 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 3s - loss: 1.5921 - accuracy: 0.2500 8/13 [=================>............] - ETA: 0s - loss: 1.5865 - accuracy: 0.312513/13 [==============================] - 0s 8ms/step - loss: 1.5849 - accuracy: 0.3190
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5836 - accuracy: 0.3750 7/13 [===============>..............] - ETA: 0s - loss: 1.5782 - accuracy: 0.321413/13 [==============================] - 0s 8ms/step - loss: 1.5757 - accuracy: 0.3392
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5643 - accuracy: 0.3750 7/13 [===============>..............] - ETA: 0s - loss: 1.5669 - accuracy: 0.383913/13 [==============================] - 0s 9ms/step - loss: 1.5666 - accuracy: 0.3646
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5659 - accuracy: 0.3438 7/13 [===============>..............] - ETA: 0s - loss: 1.5583 - accuracy: 0.401813/13 [==============================] - 0s 8ms/step - loss: 1.5575 - accuracy: 0.3975
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5510 - accuracy: 0.3750 7/13 [===============>..............] - ETA: 0s - loss: 1.5528 - accuracy: 0.370513/13 [==============================] - 0s 8ms/step - loss: 1.5485 - accuracy: 0.4076
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5500 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5430 - accuracy: 0.397313/13 [==============================] - 0s 9ms/step - loss: 1.5395 - accuracy: 0.4127
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5305 - accuracy: 0.5000 7/13 [===============>..............] - ETA: 0s - loss: 1.5334 - accuracy: 0.392913/13 [==============================] - 0s 9ms/step - loss: 1.5306 - accuracy: 0.4228
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5250 - accuracy: 0.5625 7/13 [===============>..............] - ETA: 0s - loss: 1.5258 - accuracy: 0.401813/13 [==============================] - ETA: 0s - loss: 1.5218 - accuracy: 0.435413/13 [==============================] - 0s 9ms/step - loss: 1.5218 - accuracy: 0.4354
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5067 - accuracy: 0.5938 7/13 [===============>..............] - ETA: 0s - loss: 1.5163 - accuracy: 0.450913/13 [==============================] - 0s 8ms/step - loss: 1.5130 - accuracy: 0.4481
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5141 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5049 - accuracy: 0.482113/13 [==============================] - 0s 8ms/step - loss: 1.5044 - accuracy: 0.4608
[[ 4  0 15  0  0]
 [ 0  0  0  0  0]
 [ 1  0 15  0  0]
 [ 0  0  9  0  0]
 [ 0  0  0  0  0]]
1.5475058555603027

Build model...
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_4 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_4 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_4 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 3s - loss: 1.6195 - accuracy: 0.0312 8/13 [=================>............] - ETA: 0s - loss: 1.6134 - accuracy: 0.074213/13 [==============================] - 0s 8ms/step - loss: 1.6124 - accuracy: 0.0734
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.6088 - accuracy: 0.0625 7/13 [===============>..............] - ETA: 0s - loss: 1.6065 - accuracy: 0.142913/13 [==============================] - 0s 8ms/step - loss: 1.6025 - accuracy: 0.1696
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5927 - accuracy: 0.2500 7/13 [===============>..............] - ETA: 0s - loss: 1.5955 - accuracy: 0.236613/13 [==============================] - 0s 9ms/step - loss: 1.5927 - accuracy: 0.2684
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5967 - accuracy: 0.2500 5/13 [==========>...................] - ETA: 0s - loss: 1.5885 - accuracy: 0.3438 9/13 [===================>..........] - ETA: 0s - loss: 1.5848 - accuracy: 0.371513/13 [==============================] - 0s 13ms/step - loss: 1.5830 - accuracy: 0.3797
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5705 - accuracy: 0.3438 7/13 [===============>..............] - ETA: 0s - loss: 1.5738 - accuracy: 0.406213/13 [==============================] - 0s 8ms/step - loss: 1.5733 - accuracy: 0.4430
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5767 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5669 - accuracy: 0.455413/13 [==============================] - 0s 8ms/step - loss: 1.5638 - accuracy: 0.4734
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5469 - accuracy: 0.5312 7/13 [===============>..............] - ETA: 0s - loss: 1.5559 - accuracy: 0.508913/13 [==============================] - 0s 8ms/step - loss: 1.5545 - accuracy: 0.5013
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5453 - accuracy: 0.5312 7/13 [===============>..............] - ETA: 0s - loss: 1.5454 - accuracy: 0.522313/13 [==============================] - 0s 8ms/step - loss: 1.5450 - accuracy: 0.5291
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5465 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5365 - accuracy: 0.553613/13 [==============================] - 0s 8ms/step - loss: 1.5357 - accuracy: 0.5418
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5308 - accuracy: 0.5000 7/13 [===============>..............] - ETA: 0s - loss: 1.5267 - accuracy: 0.562513/13 [==============================] - 0s 8ms/step - loss: 1.5265 - accuracy: 0.5671
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/sklearn/model_selection/_split.py:296: FutureWarning: Setting a random_state has no effect since shuffle is False. This will raise an error in 0.24. You should leave random_state to its default (None), or set shuffle=True.
  FutureWarning
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/sklearn/model_selection/_split.py:667: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=10.
  % (min_groups, self.n_splits)), UserWarning)
WARNING:tensorflow:5 out of the last 9 calls to <function Model.make_predict_function.<locals>.predict_function at 0x15c12b840> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[[12  0  7  0  0]
 [ 0  0  0  0  0]
 [ 5  0 10  1  0]
 [ 0  0  8  0  0]
 [ 0  0  1  0  0]]
1.5854642391204834

Build model...
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_5 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_5 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_5 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 3s - loss: 1.6093 - accuracy: 0.1250 8/13 [=================>............] - ETA: 0s - loss: 1.6131 - accuracy: 0.191413/13 [==============================] - 0s 8ms/step - loss: 1.6119 - accuracy: 0.2278
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.6089 - accuracy: 0.2812 8/13 [=================>............] - ETA: 0s - loss: 1.6025 - accuracy: 0.367213/13 [==============================] - 0s 8ms/step - loss: 1.6013 - accuracy: 0.3772
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5842 - accuracy: 0.6250 8/13 [=================>............] - ETA: 0s - loss: 1.5925 - accuracy: 0.453113/13 [==============================] - 0s 8ms/step - loss: 1.5909 - accuracy: 0.4405
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5940 - accuracy: 0.3438 8/13 [=================>............] - ETA: 0s - loss: 1.5832 - accuracy: 0.457013/13 [==============================] - 0s 8ms/step - loss: 1.5808 - accuracy: 0.4633
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5640 - accuracy: 0.5312 8/13 [=================>............] - ETA: 0s - loss: 1.5725 - accuracy: 0.464813/13 [==============================] - 0s 8ms/step - loss: 1.5708 - accuracy: 0.4759
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5692 - accuracy: 0.5312 8/13 [=================>............] - ETA: 0s - loss: 1.5633 - accuracy: 0.472713/13 [==============================] - 0s 8ms/step - loss: 1.5608 - accuracy: 0.4835
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5447 - accuracy: 0.5312 7/13 [===============>..............] - ETA: 0s - loss: 1.5536 - accuracy: 0.468813/13 [==============================] - 0s 8ms/step - loss: 1.5508 - accuracy: 0.4759
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5346 - accuracy: 0.5312 8/13 [=================>............] - ETA: 0s - loss: 1.5441 - accuracy: 0.468813/13 [==============================] - ETA: 0s - loss: 1.5409 - accuracy: 0.475913/13 [==============================] - 0s 9ms/step - loss: 1.5409 - accuracy: 0.4759
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5464 - accuracy: 0.2500 5/13 [==========>...................] - ETA: 0s - loss: 1.5403 - accuracy: 0.3938 9/13 [===================>..........] - ETA: 0s - loss: 1.5328 - accuracy: 0.468813/13 [==============================] - 0s 13ms/step - loss: 1.5314 - accuracy: 0.4861
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5272 - accuracy: 0.5938 7/13 [===============>..............] - ETA: 0s - loss: 1.5258 - accuracy: 0.482113/13 [==============================] - 0s 9ms/step - loss: 1.5217 - accuracy: 0.4911
WARNING:tensorflow:6 out of the last 11 calls to <function Model.make_predict_function.<locals>.predict_function at 0x15c52c840> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[[18  0  1  0  0]
 [ 0  0  0  0  0]
 [15  0  0  1  0]
 [ 6  0  2  0  0]
 [ 1  0  0  0  0]]
1.562469244003296

Build model...
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_6 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_6 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_6 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 4s - loss: 1.5924 - accuracy: 0.2188 7/13 [===============>..............] - ETA: 0s - loss: 1.5910 - accuracy: 0.187513/13 [==============================] - 0s 9ms/step - loss: 1.5912 - accuracy: 0.1797
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5915 - accuracy: 0.1250 7/13 [===============>..............] - ETA: 0s - loss: 1.5845 - accuracy: 0.174113/13 [==============================] - 0s 8ms/step - loss: 1.5814 - accuracy: 0.2152
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5688 - accuracy: 0.2500 7/13 [===============>..............] - ETA: 0s - loss: 1.5737 - accuracy: 0.236611/13 [========================>.....] - ETA: 0s - loss: 1.5723 - accuracy: 0.272713/13 [==============================] - 0s 10ms/step - loss: 1.5716 - accuracy: 0.2810
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5618 - accuracy: 0.2812 5/13 [==========>...................] - ETA: 0s - loss: 1.5648 - accuracy: 0.325010/13 [======================>.......] - ETA: 0s - loss: 1.5626 - accuracy: 0.346913/13 [==============================] - 0s 11ms/step - loss: 1.5617 - accuracy: 0.3595
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5572 - accuracy: 0.5000 7/13 [===============>..............] - ETA: 0s - loss: 1.5542 - accuracy: 0.495513/13 [==============================] - 0s 8ms/step - loss: 1.5520 - accuracy: 0.4962
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5487 - accuracy: 0.5938 7/13 [===============>..............] - ETA: 0s - loss: 1.5423 - accuracy: 0.598213/13 [==============================] - 0s 8ms/step - loss: 1.5424 - accuracy: 0.5772
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5353 - accuracy: 0.5938 7/13 [===============>..............] - ETA: 0s - loss: 1.5354 - accuracy: 0.584813/13 [==============================] - 0s 9ms/step - loss: 1.5328 - accuracy: 0.6127
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5324 - accuracy: 0.5625 7/13 [===============>..............] - ETA: 0s - loss: 1.5253 - accuracy: 0.616111/13 [========================>.....] - ETA: 0s - loss: 1.5234 - accuracy: 0.616513/13 [==============================] - 0s 12ms/step - loss: 1.5234 - accuracy: 0.6076
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5119 - accuracy: 0.5625 5/13 [==========>...................] - ETA: 0s - loss: 1.5118 - accuracy: 0.637511/13 [========================>.....] - ETA: 0s - loss: 1.5139 - accuracy: 0.627813/13 [==============================] - 0s 10ms/step - loss: 1.5142 - accuracy: 0.6152
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5293 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5109 - accuracy: 0.607113/13 [==============================] - 0s 9ms/step - loss: 1.5052 - accuracy: 0.6228
[[16  0  3  0  0]
 [ 0  0  0  0  0]
 [ 4  0 12  0  0]
 [ 1  0  7  0  0]
 [ 0  0  1  0  0]]
1.722829818725586

Build model...
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_7 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_7 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_7 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 3s - loss: 1.6143 - accuracy: 0.1562 7/13 [===============>..............] - ETA: 0s - loss: 1.6171 - accuracy: 0.138413/13 [==============================] - ETA: 0s - loss: 1.6166 - accuracy: 0.149413/13 [==============================] - 0s 9ms/step - loss: 1.6166 - accuracy: 0.1494
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.6094 - accuracy: 0.2812 7/13 [===============>..............] - ETA: 0s - loss: 1.6057 - accuracy: 0.250013/13 [==============================] - 0s 8ms/step - loss: 1.6059 - accuracy: 0.2329
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5885 - accuracy: 0.4062 7/13 [===============>..............] - ETA: 0s - loss: 1.5953 - accuracy: 0.312513/13 [==============================] - 0s 8ms/step - loss: 1.5949 - accuracy: 0.2987
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5893 - accuracy: 0.3438 7/13 [===============>..............] - ETA: 0s - loss: 1.5836 - accuracy: 0.383910/13 [======================>.......] - ETA: 0s - loss: 1.5852 - accuracy: 0.368813/13 [==============================] - 0s 13ms/step - loss: 1.5844 - accuracy: 0.3696
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5769 - accuracy: 0.3438 5/13 [==========>...................] - ETA: 0s - loss: 1.5743 - accuracy: 0.425010/13 [======================>.......] - ETA: 0s - loss: 1.5736 - accuracy: 0.409413/13 [==============================] - 0s 11ms/step - loss: 1.5739 - accuracy: 0.3949
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5700 - accuracy: 0.4062 6/13 [============>.................] - ETA: 0s - loss: 1.5622 - accuracy: 0.437511/13 [========================>.....] - ETA: 0s - loss: 1.5626 - accuracy: 0.417613/13 [==============================] - 0s 11ms/step - loss: 1.5634 - accuracy: 0.4304
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5571 - accuracy: 0.5625 7/13 [===============>..............] - ETA: 0s - loss: 1.5546 - accuracy: 0.464313/13 [==============================] - 0s 9ms/step - loss: 1.5532 - accuracy: 0.4582
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5356 - accuracy: 0.4688 7/13 [===============>..............] - ETA: 0s - loss: 1.5443 - accuracy: 0.482113/13 [==============================] - 0s 9ms/step - loss: 1.5430 - accuracy: 0.4987
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5238 - accuracy: 0.5312 7/13 [===============>..............] - ETA: 0s - loss: 1.5366 - accuracy: 0.522313/13 [==============================] - 0s 9ms/step - loss: 1.5329 - accuracy: 0.5241
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5106 - accuracy: 0.5625 7/13 [===============>..............] - ETA: 0s - loss: 1.5172 - accuracy: 0.589313/13 [==============================] - 0s 9ms/step - loss: 1.5230 - accuracy: 0.5570
[[15  0  4  0  0]
 [ 0  0  0  0  0]
 [ 2  0 14  0  0]
 [ 1  0  7  0  0]
 [ 0  0  1  0  0]]
1.7154619693756104

Build model...
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_8 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_8 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_8 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 3s - loss: 1.6231 - accuracy: 0.0625 8/13 [=================>............] - ETA: 0s - loss: 1.6177 - accuracy: 0.097713/13 [==============================] - 0s 8ms/step - loss: 1.6162 - accuracy: 0.1114
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.6074 - accuracy: 0.2812 7/13 [===============>..............] - ETA: 0s - loss: 1.6069 - accuracy: 0.196413/13 [==============================] - 0s 8ms/step - loss: 1.6061 - accuracy: 0.1797
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.6028 - accuracy: 0.1875 7/13 [===============>..............] - ETA: 0s - loss: 1.5983 - accuracy: 0.267913/13 [==============================] - 0s 8ms/step - loss: 1.5962 - accuracy: 0.2785
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5888 - accuracy: 0.2812 7/13 [===============>..............] - ETA: 0s - loss: 1.5881 - accuracy: 0.334813/13 [==============================] - 0s 8ms/step - loss: 1.5862 - accuracy: 0.3468
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5887 - accuracy: 0.2812 6/13 [============>.................] - ETA: 0s - loss: 1.5780 - accuracy: 0.375012/13 [==========================>...] - ETA: 0s - loss: 1.5761 - accuracy: 0.375013/13 [==============================] - 0s 9ms/step - loss: 1.5763 - accuracy: 0.3722
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5720 - accuracy: 0.3438 6/13 [============>.................] - ETA: 0s - loss: 1.5697 - accuracy: 0.364612/13 [==========================>...] - ETA: 0s - loss: 1.5671 - accuracy: 0.388013/13 [==============================] - 0s 9ms/step - loss: 1.5666 - accuracy: 0.3873
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5706 - accuracy: 0.1875 6/13 [============>.................] - ETA: 0s - loss: 1.5603 - accuracy: 0.390611/13 [========================>.....] - ETA: 0s - loss: 1.5569 - accuracy: 0.411913/13 [==============================] - 0s 11ms/step - loss: 1.5570 - accuracy: 0.4127
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5510 - accuracy: 0.4062 6/13 [============>.................] - ETA: 0s - loss: 1.5490 - accuracy: 0.442711/13 [========================>.....] - ETA: 0s - loss: 1.5478 - accuracy: 0.423313/13 [==============================] - 0s 10ms/step - loss: 1.5473 - accuracy: 0.4278
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5399 - accuracy: 0.4688 6/13 [============>.................] - ETA: 0s - loss: 1.5428 - accuracy: 0.416712/13 [==========================>...] - ETA: 0s - loss: 1.5382 - accuracy: 0.450513/13 [==============================] - 0s 9ms/step - loss: 1.5377 - accuracy: 0.4506
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5393 - accuracy: 0.4375 6/13 [============>.................] - ETA: 0s - loss: 1.5310 - accuracy: 0.453112/13 [==========================>...] - ETA: 0s - loss: 1.5285 - accuracy: 0.442713/13 [==============================] - 0s 9ms/step - loss: 1.5283 - accuracy: 0.4405
[[15  0  3  0  0]
 [ 1  0  0  0  0]
 [16  0  1  0  0]
 [ 5  0  3  0  0]
 [ 0  0  0  0  0]]
1.6737968921661377

Build model...
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_9 (Embedding)      (None, 400, 100)          54300     
_________________________________________________________________
flatten_9 (Flatten)          (None, 40000)             0         
_________________________________________________________________
dense_9 (Dense)              (None, 5)                 200005    
=================================================================
Total params: 254,305
Trainable params: 254,305
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
 1/13 [=>............................] - ETA: 6s - loss: 1.6125 - accuracy: 0.0625 7/13 [===============>..............] - ETA: 0s - loss: 1.6145 - accuracy: 0.093813/13 [==============================] - ETA: 0s - loss: 1.6123 - accuracy: 0.123713/13 [==============================] - 1s 9ms/step - loss: 1.6123 - accuracy: 0.1237
Epoch 2/10
 1/13 [=>............................] - ETA: 0s - loss: 1.6031 - accuracy: 0.1875 7/13 [===============>..............] - ETA: 0s - loss: 1.6034 - accuracy: 0.200911/13 [========================>.....] - ETA: 0s - loss: 1.6026 - accuracy: 0.218813/13 [==============================] - 0s 11ms/step - loss: 1.6024 - accuracy: 0.2172
Epoch 3/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5972 - accuracy: 0.1875 5/13 [==========>...................] - ETA: 0s - loss: 1.5940 - accuracy: 0.306310/13 [======================>.......] - ETA: 0s - loss: 1.5921 - accuracy: 0.343813/13 [==============================] - 0s 11ms/step - loss: 1.5924 - accuracy: 0.3460
Epoch 4/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5855 - accuracy: 0.3750 6/13 [============>.................] - ETA: 0s - loss: 1.5857 - accuracy: 0.364612/13 [==========================>...] - ETA: 0s - loss: 1.5828 - accuracy: 0.393213/13 [==============================] - 0s 10ms/step - loss: 1.5826 - accuracy: 0.3939
Epoch 5/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5794 - accuracy: 0.3750 7/13 [===============>..............] - ETA: 0s - loss: 1.5754 - accuracy: 0.428613/13 [==============================] - ETA: 0s - loss: 1.5729 - accuracy: 0.431813/13 [==============================] - 0s 9ms/step - loss: 1.5729 - accuracy: 0.4318
Epoch 6/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5673 - accuracy: 0.4688 7/13 [===============>..............] - ETA: 0s - loss: 1.5661 - accuracy: 0.442013/13 [==============================] - 0s 9ms/step - loss: 1.5633 - accuracy: 0.4444
Epoch 7/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5456 - accuracy: 0.6250 6/13 [============>.................] - ETA: 0s - loss: 1.5527 - accuracy: 0.526012/13 [==========================>...] - ETA: 0s - loss: 1.5527 - accuracy: 0.471413/13 [==============================] - 0s 9ms/step - loss: 1.5537 - accuracy: 0.4646
Epoch 8/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5445 - accuracy: 0.5000 6/13 [============>.................] - ETA: 0s - loss: 1.5500 - accuracy: 0.458312/13 [==========================>...] - ETA: 0s - loss: 1.5449 - accuracy: 0.479213/13 [==============================] - 0s 9ms/step - loss: 1.5443 - accuracy: 0.4823
Epoch 9/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5425 - accuracy: 0.4375 6/13 [============>.................] - ETA: 0s - loss: 1.5326 - accuracy: 0.500012/13 [==========================>...] - ETA: 0s - loss: 1.5355 - accuracy: 0.487013/13 [==============================] - 0s 9ms/step - loss: 1.5350 - accuracy: 0.4899
Epoch 10/10
 1/13 [=>............................] - ETA: 0s - loss: 1.5342 - accuracy: 0.4688 6/13 [============>.................] - ETA: 0s - loss: 1.5289 - accuracy: 0.510413/13 [==============================] - ETA: 0s - loss: 1.5256 - accuracy: 0.510113/13 [==============================] - 0s 9ms/step - loss: 1.5256 - accuracy: 0.5101
[[12  0  6  0  0]
 [ 0  0  0  0  0]
 [ 5  0 12  0  0]
 [ 3  1  4  0  0]
 [ 0  0  0  0  0]]
1.952786922454834


F1-scores
[0.42011308049043894, 0.49090909090909096, 0.3944618599791013, 0.3422865013774104, 0.4610389610389611, 0.26348228043143296, 0.5692307692307692, 0.5925470925470926, 0.2553374655647383, 0.5076734770737218]
Average F1 scores 0.4297080578642758
[[  0   1   0   0   0]
 [  0 135  53   0   0]
 [  0  75  88   2   0]
 [  1  23  57   0   0]
 [  0   1   3   0   0]]
